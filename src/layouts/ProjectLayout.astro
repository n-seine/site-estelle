---
import ProjectDetails from "../components/storyblok/ProjectDetails.astro";
const { story } = Astro.props;
import { storyblokEditable, renderRichText } from "@storyblok/astro";
import ClickableImage from "../components/ClickableImage.astro";
import PageTitle from "../components/PageTitle.astro";
import Image from "astro/components/Image.astro";
const blok = story.content.details[0];
---

<PageTitle
  title={story.name}
  tags={story.tag_list.join(", ")}
  altLayout={true}
/>
<article class="w-full md:px-12 max-w-4xl flex flex-col items-center">
  <div class="flex flex-col items-center justify-center">
    {
      blok.mainVisual.filename && (
        <Image
          src={blok.mainVisual.filename + "/m/1200x0"}
          alt={
            blok.mainVisual.alt || "Image illustrant le projet" + story.title
          }
          loading="eager"
          width={1200}
          height={800}
          class="w-full  mb-12 lg:mb-24 "
        />
      )
    }
    {
      blok.youtube && (
        <iframe
          class="mb-24 w-full aspect-video "
          width="100%"
          height="100%"
          src={`https://www.youtube.com/embed/${blok.youtube}`}
          title="YouTube video player"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        />
      )
    }
    <p class="text-xl px-4 font-normal text-primary not-prose text-justify">
      {blok.header}
    </p>

    {
      blok.content.map((section) => (
        <section class="mt-12">
          <h3>{section.title}</h3>
          <div
            set:html={renderRichText(section.content)}
            class="prose prose-lg max-w-3xl prose-neutral prose-p:text-neutral-600 prose-a:no-underline prose-a:text-primary hover:prose-a:underline"
          />
          <ul class="grid-cols-2 lg:grid-cols-3 grid gap-4 px-4">
            {section.gallery.map((picture) => (
              <li class="list-none m-0 p-0">
                <ClickableImage
                  picture={picture}
                  alt={
                    picture.alt || "Image illustrant le projet" + story.title
                  }
                />
              </li>
            ))}
          </ul>
        </section>
      ))
    }
  </div>
</article>

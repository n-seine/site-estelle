---
import ProjectDetails from "../components/storyblok/ProjectDetails.astro";
const { story } = Astro.props;
import { storyblokEditable, renderRichText } from "@storyblok/astro";
import ClickableImage from "../components/ClickableImage.astro";
import PageTitle from "../components/PageTitle.astro";
import Image from "astro/components/Image.astro";
const blok = story.content.details[0];
---

<article class="w-full md:px-12 max-w-6xl">
  <div>
    <div class="flex-col items-center xl:w-full flex xl:gap-12 mb-12">
      <PageTitle
        title={story.name}
        tags={story.tag_list.join(", ")}
        altLayout={true}
      />

      <div
        class="flex flex-col xl:flex-row gap-12 justify-start items-start h-fit mb-24"
      >
        {
          blok.mainVisual.filename && (
            <Image
              src={blok.mainVisual.filename + "/m/1200x0"}
              alt={
                blok.mainVisual.alt ||
                "Image illustrant le projet" + story.title
              }
              width={1200}
              height={900}
              class="  lg:h-fit w-full xl:w-2/3 pt-2 "
            />
          )
        }
        {
          blok.youtube && (
            <iframe
              width="100%"
              height="480"
              src={`https://www.youtube.com/embed/${blok.youtube}`}
              title="YouTube video player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            />
          )
        }
        <div class="flex flex-col w-full xl:w-1/3 items-center justify-start">
          <p
            class="text-xl px-4 md:px-0 font-normal text-primary not-prose text-justify"
          >
            {blok.header}
          </p>
        </div>
      </div>
    </div>

    {
      blok.content.map((section) => (
        <section class=" flex px-4 md:px-0 flex-col-reverse md:flex-row items-start justify-center gap-6 md:gap-12 mb-24">
          <ul class="sm:grid-cols-2 xl:grid-cols-3 grid gap-3 w-full  xl:w-2/3 pt-2">
            {section.gallery.map((picture) => (
              <li class="list-none m-0 p-0">
                <ClickableImage
                  picture={picture}
                  alt={
                    picture.alt || "Image illustrant le projet" + story.title
                  }
                />
              </li>
            ))}
          </ul>
          <div class="w-full  xl:w-1/3 prose text-justify prose-lg prose-neutral prose-p:text-neutral-600 prose-a:no-underline prose-a:text-primary hover:prose-a:underline">
            <h3>{section.title}</h3>
            <div set:html={renderRichText(section.content)} />
          </div>
        </section>
      ))
    }
  </div>
</article>
